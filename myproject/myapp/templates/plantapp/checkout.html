{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="max-w-4xl mx-auto bg-white rounded-2xl shadow p-8 mt-10">
  <h1 class="text-3xl font-bold text-green-700 mb-6">üí≥ ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h1>

  {% if items %}
    <!-- üîç ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ -->
    <ul class="divide-y divide-gray-200 mb-6">
      {% for item in items %}
        <li class="py-4 flex items-center space-x-4">
          {% if item.image %}
            <img src="{{ item.image }}" alt="{{ item.name }}" class="w-16 h-16 object-cover rounded-xl">
          {% else %}
            <div class="w-16 h-16 bg-gray-100 flex items-center justify-center rounded-xl text-sm text-gray-400">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏π‡∏õ</div>
          {% endif %}
          <div class="flex-1">
            <h2 class="font-semibold text-gray-800">{{ item.name }}</h2>
            <p class="text-gray-500">‡∏ø {{ item.price|floatformat:2 }}</p>
          </div>
        </li>
      {% endfor %}
    </ul>

    <!-- üí∞ ‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤ -->
    <div class="text-right text-xl font-semibold text-green-700 mb-8">
      ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ‡∏ø {{ total|floatformat:2 }}
    </div>

    <!-- üì∑ QR Code ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏û‡∏¢‡πå -->
    <div class="text-center mb-8">
      <h2 class="text-xl font-bold text-gray-800 mb-2">üì± ‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏û‡∏¢‡πå</h2>
      {% if qr_code %}
        <img src="data:image/png;base64,{{ qr_code }}" alt="QR Code" class="mx-auto w-48 h-48 border-4 border-green-500 rounded-xl shadow-md">
        <p class="text-sm text-gray-600 mt-2">
          ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏û‡∏¢‡πå: <strong class="text-green-700">094-424-5565</strong><br>
          ‡∏¢‡∏≠‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ä‡∏≥‡∏£‡∏∞: <strong class="text-green-700">‡∏ø {{ total|floatformat:2 }}</strong>
        </p>
      {% else %}
        <p class="text-red-500">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏™‡∏î‡∏á QR ‡πÑ‡∏î‡πâ</p>
      {% endif %}
      <p class="text-sm text-gray-500 mt-2">* ‡πÉ‡∏ä‡πâ‡πÅ‡∏≠‡∏õ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πÅ‡∏Å‡∏ô QR</p>
    </div>

    <!-- üì§ ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ -->
    <form method="post" action="{% url 'myapp:upload_slip' %}" enctype="multipart/form-data" class="space-y-4">
      {% csrf_token %}
      <label class="block font-medium text-gray-700">üì§ ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô</label>
      <input type="file" name="slip" required class="block w-full border border-gray-300 rounded px-4 py-2">
      <button type="submit" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded">
        ‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
      </button>
    </form>

  {% else %}
    <p class="text-gray-500">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</p>
  {% endif %}
</div>
{% endblock %}
